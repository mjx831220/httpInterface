<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="vfh.httpInterface.dao.buildings.BuildingsMapper" >
  <sql id="Base_Column_List" >
    id, city_id, area_id, map_x, map_y, developer_company_id, buildings_name, query_keyword, 
    create_time, update_time, status, open_date, deliver_date, server_phone_num, address,building_count, floor_space, building_space, house_count, green_rate, decoration_condition, 
    util_type, parking_count,floor_detail,buildings_detail
  </sql>
  <select id="get" resultType="hashmap">
        SELECT 
          <include refid="Base_Column_List" />
        FROM
          tb_buildings
        WHERE 
          id = #{id}
   </select>
  
  <delete id="delete" >
    delete from tb_buildings
    where id = #{id}
  </delete>
  <insert id="insert" useGeneratedKeys="true" keyProperty="entity.id" >
    insert into tb_buildings ( city_id, area_id, 
      map_x, map_y, 
      buildings_name, query_keyword, create_time, 
      status, open_date, 
      deliver_date, server_phone_num, address,building_count, floor_space, building_space, house_count, green_rate, decoration_condition, 
    util_type, parking_count,floor_detail,buildings_detail
      )
    values ( #{entity.cityId}, #{entity.areaId}, 
      #{entity.mapX}, #{entity.mapY}, 
      #{entity.buildingsName}, #{entity.queryKeyword}, now(), 
       #{entity.status}, #{entity.openDate}, 
      #{entity.deliverDate}, #{entity.serverPhoneNum}, #{entity.address},
      #{entity.buildingCount}, #{entity.floorSpace}, 
      #{entity.buildingSpace}, #{entity.houseCount}, #{entity.greenRate}, 
      #{entity.decorationCondition}, #{entity.utilType}, #{entity.parkingCount}, 
      #{entity.floorDetail}, #{entity.buildingsDetail}
      )
  </insert>
  <select id="count" resultType="long">
    select count(*) from tb_buildings
     WHERE
          id>0
        <if test="filter.username != null and filter.username != ''">
          <bind name="filter.username" value=" '%' + filter.username + '%' " />
          AND username LIKE #{filter.username}
        </if>

        <if test="filter.nickname != null and filter.nickname != ''">
          <bind name="filter.nickname" value=" '%' + filter.nickname + '%' " />
          AND nickname LIKE #{filter.nickname}
        </if>

        <if test="filter.state != null and filter.state != ''">
          AND state = #{filter.state}
        </if>

        <if test="filter.email != null and filter.email != ''">
          <bind name="filter.email" value=" '%' + filter.email + '%' " />
          AND email LIKE #{filter.email}
        </if>
  </select>
  <update id="update">
        UPDATE
          tb_buildings
        <set>
	      <if test="entity.cityId != null" >
	        city_id = #{entity.cityId},
	      </if>
	      <if test="entity.areaId != null" >
	        area_id = #{entity.areaId},
	      </if>
	      <if test="entity.mapX != null" >
	        map_x = #{entity.mapX},
	      </if>
	      <if test="entity.mapY != null" >
	        map_y = #{entity.mapY},
	      </if>
	      <if test="entity.developerCompanyId != null" >
	        developer_company_id = #{entity.developerCompanyId},
	      </if>
	      <if test="entity.bulidingsName != null" >
	        bulidings_name = #{entity.buildingsName},
	      </if>
	      <if test="entity.queryKeyword != null" >
	        query_keyword = #{entity.queryKeyword},
	      </if>
	      <if test="entity.createTime != null" >
	        create_time = #{entity.createTime},
	      </if>
	      <if test="entity.updateTime != null" >
	        update_time = #{entity.updateTime},
	      </if>
	      <if test="entity.status != null" >
	        status = #{entity.status},
	      </if>
	      <if test="entity.openDate != null" >
	        open_date = #{entity.openDate},
	      </if>
	      <if test="entity.deliverDate != null" >
	        deliver_date = #{entity.deliverDate},
	      </if>
	      <if test="entity.serverPhoneNum != null" >
	        server_phone_num = #{entity.serverPhoneNum},
	      </if>
	      <if test="entity.address != null" >
	        address = #{entity.address},
	      </if>
	      <if test="entity.buildingCount != null" >
	        building_count = #{entity.buildingCount},
	      </if>
	      <if test="entity.floorSpace != null" >
	        floor_space = #{entity.floorSpace},
	      </if>
	      <if test="entity.buildingSpace != null" >
	        building_space = #{entity.buildingSpace},
	      </if>
	      <if test="entity.houseCount != null" >
	        house_count = #{entity.houseCount},
	      </if>
	      <if test="entity.greenRate != null" >
	        green_rate = #{entity.greenRate},
	      </if>
	      <if test="entity.decorationCondition != null" >
	        decoration_condition = #{entity.decorationCondition},
	      </if>
	      <if test="entity.utilType != null" >
	        util_type = #{entity.utilType},
	      </if>
	      <if test="entity.parkingCount != null" >
	        parking_count = #{entity.parkingCount},
	      </if>
	      <if test="entity.floorDetail != null" >
	        floor_detail = #{entity.floorDetail},
	      </if>
	      <if test="entity.buildingDetail != null" >
	        building_detail = #{entity.buildingDetail},
	      </if>
	    </set>
        WHERE
          id = #{entity.id}
    </update>
  <select id="find" resultType="hashmap">
        SELECT
           <include refid="Base_Column_List" />
        FROM
          tb_buildings
        WHERE
          id>0
        <if test="filter.username != null and filter.username != ''">
            <bind name="filter.username" value=" '%' + filter.username + '%' " />
            AND username LIKE #{filter.username}
        </if>

        <if test="filter.nickname != null and filter.nickname != ''">
            <bind name="filter.nickname" value=" '%' + filter.nickname + '%' " />
            AND nickname LIKE #{filter.nickname}
        </if>

        <if test="filter.state != null and filter.state != ''">
            AND state = #{filter.state}
        </if>

        <if test="filter.email != null and filter.email != ''">
            <bind name="filter.email" value=" '%' + filter.email + '%' " />
            AND email LIKE #{filter.email}
        </if>
        ORDER BY id DESC
        <if test="filter.first != null and filter.last != null">
            LIMIT #{filter.first},#{filter.last}
        </if>
    </select>
</mapper>